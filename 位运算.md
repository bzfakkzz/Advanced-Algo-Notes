[90. 64位整数乘法 - AcWing题库](https://www.acwing.com/problem/content/92/)



求 a 乘 b 对 p 取模的值



分析：



快速幂，$a^b$，

将b分解为形如$2^0+2^2+\cdots+2^k$，

这样$a^b$就是$a^{2^0}\cdot a^{2^2} \cdots a^{2^k}$，

每次将b右移一位，如果当前位为1，就$ans\times (a\cdot 2^i)$



仿照快速幂思想，

将b分解为形如$2^0+2^2+\cdots+2^k$，

这样和a相乘就是$a\cdot (2^0+2^2+\cdots+2^k)$

每次将b右移一位，如果当前位为1，就$ans+(a\cdot 2^i)$



```cpp
ll qmul(ll a,ll b)
{
    ll ans=0;

    a%=p;

    while(b)
    {
        if(b&1)ans+=a,ans%p;

        b>>=1;
        a=a*2%p;
    }

    return ans;
}

void solve()
{
    cin>>a>>b>>p;

    cout<<qmul(a,b)<<endl;
}
```



```cpp
#include <bits/stdc++.h>

using namespace std;

typedef long long ll;

ll a, b, p;

ll qmul(ll a, ll b)
{
	ll ans = 0;

	// 将b进行二进制数位分解
	// 当前a为原来的a*(2^i)
	// 当前b&1==1则ans+=a

	while (b)
	{
		if (b & 1)ans += a, ans %= p;

		b >>= 1;

		a *= 2, a %= p;
	}

	return ans;
}

int main()
{
	cin >> a >> b >> p;

	cout << qmul(a, b) << endl;

	return 0;
}
```
